---
# Base Image
ee_base_image: registry.redhat.io/ansible-automation-platform-25/ee-minimal-rhel9:latest

ee_list:
  - name: ee-mitchell-labs-ocpvirt
    tag: "{{ now(fmt='%mm-%dd-%YYYY') }}"
    options:
      package_manager_path: /usr/bin/microdnf
    build_items:
      - files/
    build_files:
      - src: openshift-clients-4.17.0-202412120604.p0.gf4525b8.assembly.stream.el9.x86_64.rpm
        dest: rpms
    build_steps:
      prepend_base:
        - RUN $PYCMD -m pip install --upgrade pip setuptools
        - COPY _build/rpms/openshift-clients*.rpm /tmp/openshift-clients.rpm
        - RUN $PKGMGR -y update && $PKGMGR -y install bash-completion && $PKGMGR clean all
        - RUN rpm -ivh /tmp/openshift-clients.rpm && rm /tmp/openshift-clients.rpm
    dependencies:
      galaxy:
        collections:
          - name: redhat.openshift_virtualization

## Example Variable
# ee_list:
#   - name: custom_ee
#     alt_name: Custom EE
#     tag: 1-11-21-2
#     dependencies:
#       system:
#       - python-requests
#       - python-pyyaml
#       python:
#         - pytz
#         - python-dateutil>=2.7.0
#         - awxkit
#       galaxy:
#         collections:
#           - name: awx.awx
#             version: 22.4.0
#           - infra.controller_configuration
#           - ansible.controller
#           - infra.ah_configuration
#     build_items:
#       - files/
#       - test.yml
#     build_files:
#       - src: files/stuff.txt
#         dest: folders
#       - src: test.yml
#         dest: folders
#     build_steps:
#       prepend_final:
#         - ADD _build/folders/stuff.txt /etc/ansible/stuff.txt
#         - ADD _build/folders/test.yml /etc/ansible/test.yml
#       append_final:
#         - RUN echo This is a post-install command!
